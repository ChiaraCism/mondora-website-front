!function(){var t={host:"http://localhost:3000",do_not_autocreate_collections:!0};t.ddpOptions={endpoint:"ws://localhost:3000/websocket",SocketConstructor:WebSocket},window.Ceres=new Asteroid(t)}(),angular.module("mnd.web",["ui.bootstrap","ui.router","mnd.sprinkle","mnd.dashboard","asteroid","angularFileUpload","ngSanitize"]).config(["$stateProvider","$urlRouterProvider",function(t,o){t.state("home",{url:"/",templateUrl:"pages/home/home.html",controller:"HomeController",resolve:{homeConfig:function(){return Ceres.subscribe("configurations")}}}),t.state("postView",{url:"/post/:postId",templateUrl:"pages/post/view/postView.html",controller:"PostViewController",resolve:{postSub:function(){return Ceres.subscribe("posts")}}}),t.state("postEdit",{url:"/post/:postId/edit",templateUrl:"pages/post/edit/postEdit.html",controller:"PostEditController",resolve:{postSub:function(){return Ceres.subscribe("posts")}}}),t.state("postList",{url:"/posts",templateUrl:"pages/post/list/postList.html",controller:"PostListController",resolve:{postSub:function(){return Ceres.subscribe("posts")}}}),o.otherwise("/")}]).run(["$rootScope",function(t){t.safeApply=function(o){var e=t.$$phase;"$apply"===e||"$digest"===e?"function"==typeof o&&o():this.$apply(o)},t.Ceres=Ceres,t.Configurations=Ceres.createCollection("configurations"),t.Posts=Ceres.createCollection("posts"),Ceres.on("login",function(){t.safeApply(function(){t.signedIn=!0})}),Ceres.on("logout",function(){t.safeApply(function(){t.signedIn=!1})})}]),angular.module("mnd.web").controller("SidebarController",["$scope","$state",function(t,o){t.addPost=function(){var e={};t.Posts.insert(e),o.go("postEdit",{postId:e._id})},t.menu={items:[{title:"Home",href:"/"},{title:"Nuovo post",ngClick:"addPost"},{title:"cloud",href:"http://www.mondora.com"},{title:"governance",href:"http://www.mondora.com"},{title:"team",href:"http://www.mondora.com"},{title:"formazione",href:"http://www.mondora.com"},{title:"community",href:"http://www.mondora.com"},{title:"my mondora",type:"submenu",items:[{title:"pomodoro",href:"http://www.mondora.com"},{title:"AaS",href:"http://www.mondora.com"}]}]}}]),angular.module("mnd.web").controller("HomeController",["$scope","$collection",function(t){var o;t.Configurations.db.itemsArray.forEach(function(t){"home"===t.page&&(o=t)}),t.sprinkleText=o.sprinkleText,t.banner=o.banner,t.login=function(){t.Ceres.loginWithTwitter()}}]),angular.module("mnd.web").controller("PostEditController",["$scope","$interval","$stateParams","$upload",function(t,o,e,n){var r=e.postId;t.post=t.Posts.db.get(r),window.Posts=t.Posts;var s=document.getElementById("postTitleEditor");s.innerHTML=t.post.title||"";var i={placeholder:"Titolo",disableToolbar:!0,forcePlainText:!0,disableReturn:!0};new MediumEditor(s,i);var l=document.getElementById("postSubtitleEditor");l.innerHTML=t.post.subtitle||"";var a={placeholder:"Sottotitolo",disableToolbar:!0,forcePlainText:!0,disableReturn:!0};new MediumEditor(l,a);var p=document.getElementById("postBodyEditor");p.innerHTML=t.post.body||"";var d={placeholder:"Corpo",buttonLabels:"fontawesome",buttons:["bold","italic","anchor","header1","header2","quote"]};new MediumEditor(p,d),t.publishPost=function(){t.post.published=!0,t.save()},t.unpublishPost=function(){t.post.published=!1,t.save()},t.clickFileInput=function(){document.querySelector("#post-edit-image-upload input").click()},t.titleImageIsDisplayed=void 0!==t.post.titleImageSource,t.abortUpload=function(){t.uploadProgress=0,t.isUploading=!1,t.imageUpload.abort(),delete t.imageUpload},t.onFileSelect=function(o){var e=o[0];if(!/image/g.test(e.type))return void alert("Devi caricare un'immagine.");var r=Math.round(1e16*Math.random()),s=r+"__"+e.name,i={url:"https://ngtest.s3.amazonaws.com/",method:"POST",data:{key:s,acl:"public-read","Content-Type":e.type},file:e};t.isUploading=!0,t.imageUpload=n.upload(i).progress(function(o){t.uploadProgress=parseInt(100*o.loaded/o.total)}).success(function(){t.uploadProgress=100,t.isUploading=!1,t.post.titleImageSource="https://s3-eu-west-1.amazonaws.com/ngtest/"+s,t.save()}).error(function(){})},t.save=function(){t.post.title=s.innerHTML,t.post.subtitle=l.innerHTML,t.post.body=p.innerHTML;var o=angular.copy(t.post);delete o._id,t.Posts.update(r,o)},o(t.save,5e3)}]),angular.module("mnd.web").controller("PostListController",["$timeout","$scope","$collection",function(t,o){t(function(){o.posts=o.Posts.db.itemsArray},500)}]),angular.module("mnd.web").controller("PostViewController",["$scope","$stateParams",function(t,o){var e=o.postId;t.post=t.Posts.db.get(e)}]);