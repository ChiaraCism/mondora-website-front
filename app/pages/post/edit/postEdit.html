<!-- Post deletion modal -->
<div class="modal-background" ng-if="showDelete">
	<div id="delete-post-modal" class="modal-dialog">
		<div class="modal-content">
	    	<div class="modal-header">
				Are you sure you want to delete this post?
			</div>
			<div class="modal-body">
				<button type="button" class="btn btn-default yes" ng-click="deletePost()">
					Yes
				</button>
				<button type="button" class="btn btn-default no" ng-click="toggleDelete()">
					No
				</button>
			</div>
		</div>
	</div>
</div>

<!-- Permissions editor modal -->
<div class="modal-background" ng-if="showPermissionsEditor">
	<div class="modal-dialog">
		<div class="modal-content">
	    	<div class="modal-header">
				Edit permissions
			</div>
			<div class="modal-body">

				<div tabset>

					<div tab heading="Visibility">
						<br />
						<div mnd-permissions-editor permissions="post.permissions"></div>
					</div>

					<div tab heading="Authors" ng-controller="PostAuthorsController">

						<label>Authors</label>
						<div class="participant-list" ng-repeat="author in post.authors">
							<div class="mnd-inline-block mnd-valign-middle" mnd-cig-image source="author.pictureUrl" size="30"></div>
							<span>{{author.name}}</span>
							<span class="pull-right mnd-clickable" ng-click="deleteAuthor($index)">
								<i class="fa fa-times-circle"></i>
							</span>
						</div>
						<div class="input-group">
							<input type="text" class="form-control" placeholder="Add member" mnd-user-input user-model="author.model" />
							<span class="input-group-addon mnd-clickable" ng-click="addAuthor()">
								<i class="fa fa-plus-circle"></i>
							</span>
						</div>

					</div>

					<div tab heading="Channels">
					</div>

				</div>

				<br />
				<div class="text-right">
					<button type="button" class="btn btn-default" ng-click="togglePermissionsEditor()">
						Close
					</button>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="post-cant-edit" ng-show="isMobile">Content not accessible from mobile devices.</div> 
<div class="post-title-image" ng-show="!isMobile">
	<img ng-src="{{post.titleImageUrl}}" ng-if="titleImageIsDisplayed()" alt="Immagine principale" />
</div>

<div class="post-top-buttons" ng-if="isAuthor()" ng-show="!isMobile">
	<button type="button" class="btn btn-default" ng-click="toggleDelete()" ng-if="isOwner() && !showDelete">
		Delete
	</button>
	<button type="button" class="btn btn-default" ng-click="togglePermissionsEditor()">
		Share
	</button>
	<button type="button" class="btn btn-default" ng-click="publishPost()" ng-if="isOwner() && !post.published">
		Publish
	</button>
	<button type="button" class="btn btn-default" ng-click="unpublishPost()" ng-if="isOwner() && post.published">
		Unpublish
	</button>
	<a ui-sref="postView({postId: post._id})" class="btn btn-default">
		Preview
	</a>
</div>

<div class="mnd-mind-container grey-border" ng-class="{'black-connections': !titleImageIsDisplayed()}" ng-show="!isMobile" ng-keyup="processMap($event)">
	<div mnd-mind-map map="post.map" edit="true"></div>
</div>

<div class="post-header" ng-show="!isMobile">
	<div class="col-sm-2 col-sm-offset-2" id="post-edit-image-upload">
		<i class="fa fa-picture-o" mnd-s3-file-upload file-type="image" after-upload="afterUploadTitleImage" is-uploading="isUploadingTitleImage" upload-progress="uploadProgressTitleImage"></i>
	</div>
	<div class="col-sm-5" id="post-edit-image-upload-progressbar">
		<br />
		<br />
		<span ng-show="isUploadingTitleImage">
			<div progressbar value="uploadProgressTitleImage"></div>
		</span>
	</div>
	<div class="col-sm-1" id="post-edit-image-upload-abort">
		<br />
		<br />
		<i class="fa fa-times" ng-show="isUploadingTitleImage" ng-click="abortUpload('titleImage')"></i>
	</div>
	<div class="col-sm-8 col-sm-offset-2">
		<h1
			class="simplebox post-title"
			ng-class="{'color-me-white': titleImageIsDisplayed()}"
			mnd-medium-editor
			content="post.title"
			options="titleEditorOptions">
		</h1>
		<h2
			class="simplebox post-subtitle"
			ng-class="{'color-me-white': titleImageIsDisplayed()}"
			mnd-medium-editor
			content="post.subtitle"
			options="subtitleEditorOptions">
		</h2>
	</div>
</div>

<div class="post-body" ng-show="!isMobile">
	<div class="col-sm-8 col-sm-offset-2">
		<div class="simplebox" mnd-medium-editor content="post.body" options="bodyEditorOptions"></div>
	</div>
</div>
